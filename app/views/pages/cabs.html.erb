<% content_for :body_class do %>bg-black<% end %>
<% content_for :main_class do %>p-0<% end %>
<% content_for :footer_class do %>text-white/20 border-white/10 mt-0<% end %>

<%# ── Thin page header ────────────────────────────────── %>
<div class="flex items-center justify-between px-5 py-3 border-b border-white/10">
  <p class="text-[10px] tracking-[0.4em] text-white/30 uppercase">Cabinet Catalog</p>
  <p class="text-[10px] tracking-[0.4em] text-white/20"><%= @cabs.length %> pieces</p>
</div>

<%# ── Editorial grid ──────────────────────────────────── %>
<%
  # Explicit grid position for each of the 12 cabs
  # [grid-column, grid-row]
  placements = [
    ["1 / 3", "1 / 3"],  # 0: 2×2 large
    ["3 / 4", "1 / 2"],  # 1: 1×1
    ["4 / 5", "1 / 2"],  # 2: 1×1
    ["3 / 4", "2 / 3"],  # 3: 1×1
    ["4 / 5", "2 / 3"],  # 4: 1×1
    ["1 / 2", "3 / 5"],  # 5: 1×2 tall
    ["2 / 4", "3 / 4"],  # 6: 2×1 wide
    ["4 / 5", "3 / 5"],  # 7: 1×2 tall
    ["2 / 3", "4 / 5"],  # 8: 1×1
    ["3 / 4", "4 / 5"],  # 9: 1×1
    ["1 / 3", "5 / 6"],  # 10: 2×1 wide
    ["3 / 5", "5 / 6"],  # 11: 2×1 wide
  ]

  # Subtle warm-dark background tints per card
  bgs = %w[
    #0f0e0c #111110 #100f0d #0e0e0e #110f0d
    #0f0d0b #101010 #0e0f0c #110e0d #0f0f0f
    #100d0b #0f0e0d
  ]
%>

<div style="
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  grid-template-rows: repeat(5, 25vw);
  gap: 3px;
  background: #000;
">
  <% @cabs.each_with_index do |cab, i| %>
    <% col, row = placements[i] %>
    <div class="group relative overflow-hidden"
         style="grid-column: <%= col %>; grid-row: <%= row %>; background: <%= bgs[i] %>;">

      <%# Full-card link sits beneath everything %>
      <%= link_to cab_path(cab[:id]), class: "absolute inset-0 z-0", aria: { label: cab[:name] } %>

      <%# Ghost year text in background %>
      <div class="absolute inset-0 flex items-center justify-center pointer-events-none select-none overflow-hidden">
        <span class="font-black text-white leading-none" style="font-size: clamp(3rem, 12vw, 14rem); opacity: 0.025;"><%= cab[:year] %></span>
      </div>

      <%# Speaker SVG — faint center icon %>
      <div class="absolute inset-0 flex items-center justify-center pointer-events-none"
           style="color: rgba(255,255,255,0.05);">
        <svg viewBox="0 0 72 72" fill="none" style="width: min(45%, 140px); height: min(45%, 140px);">
          <circle cx="36" cy="36" r="33" stroke="currentColor" stroke-width="0.8"/>
          <circle cx="36" cy="36" r="23" stroke="currentColor" stroke-width="0.6"/>
          <circle cx="36" cy="36" r="14" stroke="currentColor" stroke-width="0.6"/>
          <circle cx="36" cy="36" r="6"  stroke="currentColor" stroke-width="0.8"/>
          <circle cx="36" cy="36" r="2.5" fill="currentColor"/>
          <line x1="36" y1="3"  x2="36" y2="13" stroke="currentColor" stroke-width="0.5"/>
          <line x1="36" y1="59" x2="36" y2="69" stroke="currentColor" stroke-width="0.5"/>
          <line x1="3"  y1="36" x2="13" y2="36" stroke="currentColor" stroke-width="0.5"/>
          <line x1="59" y1="36" x2="69" y2="36" stroke="currentColor" stroke-width="0.5"/>
        </svg>
      </div>

      <%# Default label — bottom left, always visible %>
      <div class="absolute bottom-0 left-0 right-0 p-4 z-10 pointer-events-none
                  translate-y-0 group-hover:translate-y-full transition-transform duration-300 ease-in-out">
        <p class="text-[9px] tracking-[0.3em] text-white/25 uppercase mb-1"><%= cab[:size] %> · <%= cab[:year] %></p>
        <p class="text-xs font-bold text-white/50 uppercase tracking-wide leading-tight"><%= cab[:name] %></p>
      </div>

      <%# Hover overlay — slides up from bottom %>
      <div class="absolute inset-0 z-10 flex flex-col justify-end p-5
                  translate-y-full group-hover:translate-y-0 transition-transform duration-300 ease-in-out"
           style="background: linear-gradient(to top, rgba(0,0,0,0.95) 0%, rgba(0,0,0,0.7) 60%, transparent 100%);">

        <p class="text-[9px] tracking-[0.35em] text-white/35 uppercase mb-2"><%= cab[:size] %> · <%= cab[:finish] %> · <%= cab[:condition] %></p>
        <p class="font-black text-white uppercase leading-none mb-3" style="font-size: clamp(0.85rem, 1.8vw, 1.4rem); letter-spacing: 0.04em;"><%= cab[:name] %></p>
        <p class="text-2xl font-black text-amber-400 mb-4">$<%= number_with_delimiter(cab[:price]) %></p>

        <div class="flex gap-2 relative z-20">
          <%= link_to "VIEW →", cab_path(cab[:id]),
                class: "text-[9px] tracking-widest border border-white/20 px-3 py-2 text-white/60 hover:text-white hover:border-white/50 transition-colors" %>
          <%= form_with url: cart_add_path, method: :post, local: true do |f| %>
            <%= f.hidden_field :cab_id, value: cab[:id] %>
            <%= f.submit "+ CART",
                  class: "text-[9px] tracking-widest bg-amber-400 hover:bg-amber-300 text-black font-bold px-3 py-2 cursor-pointer transition-colors" %>
          <% end %>
        </div>

      </div>
    </div>
  <% end %>
</div>
