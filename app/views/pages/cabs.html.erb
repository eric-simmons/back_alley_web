<% content_for :body_class do %>sp-page font-mono<% end %>
<% content_for :main_class do %>max-w-screen-xl mx-auto px-8 py-14<% end %>
<% content_for :footer_class do %><style>footer { color: #4a3220; border-color: #2a1a0c; }</style><% end %>

<%# ── Page Header ─────────────────────────────────────── %>
<div class="mb-12">
  <div class="flex items-center gap-5 mb-6">
    <span class="animate-gear-cw text-2xl select-none" style="animation-duration: 22s; color: #5a3a20; display:inline-block;">⚙</span>
    <div>
      <p class="text-xs tracking-[0.4em] uppercase mb-1" style="color: #5a3820;">Back Alley Studio · Catalog</p>
      <h1 class="text-5xl font-bold tracking-tight leading-none" style="color: #c8a870;">Cabinet<br><span class="text-6xl" style="color: #c07838;">Catalog</span></h1>
    </div>
    <span class="animate-gear-ccw text-xl select-none ml-auto self-end mb-2" style="animation-duration: 14s; color: #5a3a20; display:inline-block;">⚙</span>
  </div>
  <div class="h-px" style="background: linear-gradient(to right, #c07838, #4a2a10, transparent);"></div>
</div>

<%# ── Cab Grid ─────────────────────────────────────────── %>
<div class="grid grid-cols-2 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-5">
  <% @cabs.each do |cab| %>
    <div class="cab-card relative" style="border: 1px solid #2a1a0c;">

      <%# Rivet corners %>
      <div class="rivet" style="top:8px; left:8px;"></div>
      <div class="rivet" style="top:8px; right:8px;"></div>
      <div class="rivet" style="bottom:8px; left:8px;"></div>
      <div class="rivet" style="bottom:8px; right:8px;"></div>

      <%# Card body %>
      <div class="overflow-hidden" style="background: linear-gradient(145deg, #181208 0%, #0c0a07 100%);">

        <%# Speaker diagram %>
        <div class="flex flex-col items-center justify-center gap-3 pt-8 pb-5 px-6">
          <div class="animate-copper-pulse" style="color: #3a2818;">
            <svg width="60" height="60" viewBox="0 0 72 72" fill="none" xmlns="http://www.w3.org/2000/svg">
              <circle cx="36" cy="36" r="33" stroke="currentColor" stroke-width="1.2"/>
              <circle cx="36" cy="36" r="23" stroke="currentColor" stroke-width="1"/>
              <circle cx="36" cy="36" r="14" stroke="currentColor" stroke-width="1"/>
              <circle cx="36" cy="36" r="6"  stroke="currentColor" stroke-width="1.2"/>
              <circle cx="36" cy="36" r="2.5" fill="currentColor"/>
              <line x1="36" y1="3"  x2="36" y2="13" stroke="currentColor" stroke-width="0.8"/>
              <line x1="36" y1="59" x2="36" y2="69" stroke="currentColor" stroke-width="0.8"/>
              <line x1="3"  y1="36" x2="13" y2="36" stroke="currentColor" stroke-width="0.8"/>
              <line x1="59" y1="36" x2="69" y2="36" stroke="currentColor" stroke-width="0.8"/>
            </svg>
          </div>
          <div class="text-center">
            <p class="text-xs tracking-[0.25em] font-bold" style="color: #c8a060;"><%= cab[:name].upcase %></p>
            <p class="text-[10px] tracking-widest mt-1" style="color: #4a3218;"><%= cab[:size] %> · <%= cab[:year] %></p>
          </div>
        </div>

        <%# Specs %>
        <div class="px-5 pb-4 space-y-1">
          <% { "WOOD" => cab[:wood].upcase, "FINISH" => cab[:finish].upcase, "COND" => cab[:condition].upcase }.each do |label, val| %>
            <div class="flex items-baseline justify-between gap-2">
              <span class="text-[9px] tracking-widest shrink-0" style="color: #4a3218;"><%= label %></span>
              <span class="text-[9px] flex-1 overflow-hidden" style="color: #2a1e10;">...............</span>
              <span class="text-[10px] font-bold shrink-0" style="color: #7a4a20;"><%= val %></span>
            </div>
          <% end %>
        </div>

        <%# Price + actions %>
        <div class="px-5 pb-5 pt-3" style="border-top: 1px solid #1e1408;">
          <p class="text-lg font-bold mb-3" style="color: #c07838;">$<%= number_with_delimiter(cab[:price]) %></p>
          <div class="flex gap-2">
            <%= link_to cab_path(cab[:id]),
                  class: "flex-1 text-center text-[9px] tracking-widest py-1.5 transition-colors",
                  style: "border: 1px solid #2a1e10; color: #5a3820;" do %>
              VIEW →
            <% end %>
            <%= form_with url: cart_add_path, method: :post, local: true, style: "flex:1;" do |f| %>
              <%= f.hidden_field :cab_id, value: cab[:id] %>
              <%= f.submit "＋ CART",
                    class: "w-full text-[9px] tracking-widest py-1.5 cursor-pointer transition-colors hover:brightness-125",
                    style: "border: 1px solid #5a3820; color: #c8a060; background: #1a1005;" %>
            <% end %>
          </div>
        </div>

      </div>
    </div>
  <% end %>
</div>

<%# ── Bottom rule ─────────────────────────────────────── %>
<div class="flex items-center gap-4 mt-16">
  <div class="h-px flex-1" style="background: linear-gradient(to right, transparent, #2a1a0c);"></div>
  <span class="text-xs tracking-[0.4em]" style="color: #3a2410;">⚙ END OF CATALOG ⚙</span>
  <div class="h-px flex-1" style="background: linear-gradient(to left, transparent, #2a1a0c);"></div>
</div>
